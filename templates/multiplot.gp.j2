#!/usr/bin/env gnuplot
# Multiplot books in the same figure.
# The variables are the measures studied like 'Betweenness x Lobby'.

{% include 'settings.gp.j2' %}

ncols = {{ ncols }}
nrows = {{ nrows }}

# set logscale xy
# set format '$%g$'
# set format x '$10^{\%T}$'
# set format y '$10^{\%T}$'

# MACROS

## AXIS
NOXTICS = "set xtics ('' 0.0, '' .5, '' 1.0)"
NOYTICS = "set ytics ('' 0.0, '' .5)"
NOX = "unset xlabel; @NOXTICS"
NOY = "unset ylabel; @NOYTICS"
#XTICS = "set xlabel '{{ plotinfo.xlabel }}'; set xtics ('10^{-3}' 1e-3, '10^{-2}' 1e-2, '10^{-1}' 1e-1)"
#YTICS = "set ylabel '{{ plotinfo.ylabel }}'; set ytics ('10^{-3}' 1e-3, '10^{-2}' 1e-2, '10^{-1}' 1e-1)"
XTICS = "@XLABEL; set xtics ('0.0' 0.0, '0.5' .5)"
XTICS1 = "@XLABEL; set xtics ('0.0' 0.0,  '0.5' .5, '1.0' 1.0)"
{% if plot_measure == 'centralities' %}
YTICS = "@YLABEL; set ytics ('0.0' 0.0,  '0.25' .25)"
YTICS1 = "@YLABEL; set ytics ('0.0' 0.0,  '0.25' .25, '0.5' 0.5)"
{% else %}
YTICS = "@YLABEL; set ytics ('0.0' 0.0,  '0.5' .5)"
YTICS1 = "@YLABEL; set ytics ('0.0' 0.0,  '0.5' .5, '1.0' 1.0)"
{% endif %}

# END of MACROS

# PLOT
spc = .04
## vertical
top = 1 - spc
vspace = 1 - 4*spc
## horizontal
left = 3*spc
hspace = 1 - 6*spc

set multiplot layout {{ nrows }},{{ ncols }} rowsfirst

{% for datainfo in plotinfo.datainfos %}
# set x
{% if loop.index0 < 9 %}
@NOX
{% else %}
{% if loop.index0 == 11 %}
@XTICS1
{% else %}
@XTICS
{% endif %}
{% endif %}

# set y
{% if loop.index0 % 3 == 0 %}
{% if loop.index0 == 0 %}
@YTICS1
{% else %}
@YTICS
{% endif %}
{% else %}
@NOY
{% endif %}

tmargin_ = top - ({{ loop.index0 }}/ncols)*(vspace/nrows)
bmargin_ = tmargin_ - vspace/nrows
set tmargin at screen gprintf("%1.2f", tmargin_)
set bmargin at screen gprintf("%1.2f", bmargin_)

lmargin_ = left + ({{ loop.index0 }}%ncols)*(hspace/ncols)
rmargin_ = lmargin_ + (hspace/ncols)
set lmargin at screen gprintf("%1.2f", lmargin_)
set rmargin at screen gprintf("%1.2f", rmargin_)

{% if plot_measure == 'centralities' or plot_measure == 'density' %}
{% include 'fit.gp.j2' %}
{% else %}
{% include 'avg.gp.j2' %}
{% endif %}

{% endfor %}

